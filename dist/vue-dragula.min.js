/*!
 * vue-dragula v1.0.3
 * (c) 2016 Yichang Liu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("dragula")):"function"==typeof define&&define.amd?define(["dragula"],n):e.vueDragula=n(e.dragula)}(this,function(e){"use strict";function n(n){var i=new t(n),a="globalBag",o=void 0;n.vueDragula={options:i.setOptions.bind(i),eventBus:i.eventBus},n.directive("dragula",{params:["bag"],bind:function(){var n=this.el,t=this.params.bag;void 0!==t&&0!==t.length&&(a=t);var r=i.find(a);return r?(o=r.drake,void o.containers.push(n)):(o=e({containers:[n]}),i.add(a,o),void i.handleModels(a,o))},update:function(e,n){if(e)if(o.models){var i=n?o.models.indexOf(n):-1;i>=0?o.models.splice(i,1,e):o.models.push(e)}else o.models=[e]},unbind:function(){var e=this.el,n="globalBag",a=this.params.bag;void 0!==a&&0!==a.length&&(n=a);var t=i.find(n).drake;if(t){var o=t.containers.indexOf(e);o>-1&&t.containers.splice(o,1),0===t.containers.length&&i.destroy(n)}}})}function i(e){arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i.installed&&console.warn("[vue-dragula] already installed."),n(e)}e="default"in e?e["default"]:e;var a={};if(a.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},a.createClass=function(){function e(e,n){for(var i=0;i<n.length;i++){var a=n[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,i,a){return i&&e(n.prototype,i),a&&e(n,a),n}}(),!e)throw new Error("[vue-dragula] cannot locate dragula.");var t=function(){function n(e){a.classCallCheck(this,n),this.bags=[],this.eventBus=new e,this.events=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","dropModel","removeModel"]}return a.createClass(n,[{key:"add",value:function(e,n){var i=this.find(e);if(i)throw new Error('Bag named: "'+e+'" already exists.');return i={name:e,drake:n},this.bags.push(i),n.models&&this.handleModels(e,n),i.initEvents||this.setupEvents(i),i}},{key:"find",value:function(e){for(var n=this.bags,i=0;i<n.length;i++)if(n[i].name===e)return n[i]}},{key:"handleModels",value:function(e,n){var i=this;if(!n.registered){var a=void 0,t=void 0,o=void 0,r=void 0;n.on("remove",function(a,o){n.models&&(r=n.models[n.containers.indexOf(o)],r.splice(t,1),i.eventBus.$emit("removeModel",[e,a,o]))}),n.on("drag",function(e,n){a=e,t=i.domIndexOf(e,n)}),n.on("drop",function(s,d,l){if(n.models&&d){if(o=i.domIndexOf(s,d),r=n.models[n.containers.indexOf(l)],d===l)r.splice(o,0,r.splice(t,1)[0]);else{var u=a===s,f=n.models[n.containers.indexOf(d)],c=u?r[t]:JSON.parse(JSON.stringify(r[t]));u&&r.splice(t,1),f.splice(o,0,c)}i.eventBus.$emit("dropModel",[e,s,d,l])}}),n.registered=!0}}},{key:"destroy",value:function(e){var n=this.find(e);if(n){var i=this.bags.indexOf(n);this.bags.splice(i,1),n.drake.destroy()}}},{key:"setOptions",value:function(n,i){var a=this.add(n,e(i));this.handleModels(n,a.drake)}},{key:"setupEvents",value:function(e){e.initEvents=!0;var n=this,i=function(i){function a(){var a=Array.prototype.slice.call(arguments);n.eventBus.$emit(i,[e.name].concat(a))}e.drake.on(i,a)};this.events.forEach(i)}},{key:"domIndexOf",value:function(e,n){return Array.prototype.indexOf.call(n.children,e)}}]),n}();if(!e)throw new Error("[vue-dragula] cannot locate dragula.");return i.version="1.0.0","function"==typeof define&&define.amd?define([],function(){}):window.Vue&&window.Vue.use(i),i});