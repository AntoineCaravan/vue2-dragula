/*!
 * vue-dragula v1.0.0
 * (c) 2016 Yichang Liu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("dragula")):"function"==typeof define&&define.amd?define(["dragula"],n):e.vueDragula=n(e.dragula)}(this,function(e){"use strict";function n(n){var t=new a(n),i="globalBag",o=void 0;n.vueDragula={options:t.setOptions,eventBus:t.eventBus},n.directive("dragula",{params:["bag"],bind:function(){var n=this.el,a=this.params.bag;void 0!==a&&0!==a.length&&(i=a);var r=t.find(i);return r?(o=r.drake,void o.containers.push(n)):(o=e({containers:[n]}),t.add(i,o),void t.handleModels(i,o))},update:function(e,n){if(e)if(o.models){var t=n?o.models.indexOf(n):-1;t>=0?o.models.splice(t,1,e):o.models.push(e)}else o.models=[e]},unbind:function(){t.destroy(i)}})}function t(e){arguments.length<=1||void 0===arguments[1]?{}:arguments[1];t.installed&&console.warn("[vue-dragula] already installed."),n(e)}e="default"in e?e["default"]:e;var i={};if(i.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},i.createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),!e)throw new Error("[vue-dragula] cannot locate dragula.");var a=function(){function n(e){i.classCallCheck(this,n),this.bags=[],this.eventBus=new e,this.events=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","dropModel","removeModel"]}return i.createClass(n,[{key:"add",value:function(e,n){var t=this.find(e);if(t)throw new Error('Bag named: "'+e+'" already exists.');return t={name:e,drake:n},this.bags.push(t),n.models&&this.handleModels(e,n),t.initEvents||this.setupEvents(t),t}},{key:"find",value:function(e){for(var n=this.bags,t=0;t<n.length;t++)if(n[t].name===e)return n[t]}},{key:"handleModels",value:function(e,n){var t=this;if(!n.registered){var i=void 0,a=void 0,o=void 0,r=void 0;n.on("remove",function(i,o){n.models&&(r=n.models[n.containers.indexOf(o)],r.splice(a,1),t.eventBus.$emit("removeModel",[e,i,o]))}),n.on("drag",function(e,n){i=e,a=t.domIndexOf(e,n)}),n.on("drop",function(d,s,l){if(n.models&&s){if(o=t.domIndexOf(d,s),r=n.models[n.containers.indexOf(l)],s===l)r.splice(o,0,r.splice(a,1)[0]);else{var u=i===d,f=n.models[n.containers.indexOf(s)],c=u?r[a]:JSON.parse(JSON.stringify(r[a]));u&&r.splice(a,1),f.splice(o,0,c)}t.eventBus.$emit("dropModel",[e,d,s,l])}}),n.registered=!0}}},{key:"destroy",value:function(e){var n=this.find(e);if(n){var t=this.bag.indexOf(n);this.bags.splice(t,1),n.drake.destroy()}}},{key:"setOptions",value:function(n,t){var i=this.add(n,e(t));this.handleModels(n,i.drake)}},{key:"setupEvents",value:function(e){e.initEvents=!0;var n=this,t=function(t){function i(){var i=Array.prototype.slice.call(arguments);n.eventBus.$emit(t,[e.name].concat(i))}e.drake.on(t,i)};this.events.forEach(t)}},{key:"domIndexOf",value:function(e,n){return Array.prototype.indexOf.call(n.children,e)}}]),n}();if(!e)throw new Error("[vue-dragula] cannot locate dragula.");return t.version="1.0.0","function"==typeof define&&define.amd?define([],function(){}):window.Vue&&window.Vue.use(t),t});